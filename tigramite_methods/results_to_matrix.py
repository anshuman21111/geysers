import numpy as np
import pandas as pd

file1 = "tigramite_matrices/fullci_corr_mci_5min_val.csv"
file2 = "tigramite_matrices/fullci_corr_mci_5min_time.csv"

arr = [[[0.,0.61,-0.01,0.06,0.03,0.03,0.03],
[0.04,0.03,0.01,-0.,-0.,0.,-0.01],
[0.06,-0.,-0.,-0.01,0.,-0.,-0.,],
[0.12,0.09,0.,-0.01,-0.,-0.01,-0.03],
[0.02,0.01,0.01,-0.,0.,-0.,0.01],
[0.02,0.01,0.,-0.,0.,-0.,-0.,],
[0.03,0.02,-0.01,-0.,0.,-0.,-0.01],
[0.02,0.01,0.01,-0.,-0.,-0.,-0.,],
[0.04,0.02,-0.01,0.01,-0.01,0.,-0.,],
[0.,0.,-0.,-0.,0.,0.,-0.,]],

[[0.04,0.04,0.01,0.01,0.01,0.01,0.01],
[0.,0.65,-0.15,0.09,0.,0.02,0.02],
[0.,0.,-0.,0.,-0.,0.,-0.,],
[0.04,0.04,0.,0.01,0.01,0.,0.02],
[0.,0.01,0.,0.01,0.,-0.,0.01],
[0.01,0.01,-0.,0.,0.,-0.,0.01],
[0.,0.01,-0.,0.01,0.,0.,0.,],
[0.01,0.,0.,-0.,0.01,-0.01,0.01],
[0.01,0.,0.,-0.,0.,0.,-0.01],
[0.01,0.01,-0.01,0.,-0.,-0.,0.01]],

[[0.06,0.01,-0.,-0.,-0.,-0.,-0.01],
[0.,-0.,-0.,0.,-0.,-0.01,0.,],
[0.,0.54,0.22,-0.,0.03,-0.01,0.01],
[0.03,0.02,0.,-0.01,-0.,0.,0.01],
[0.01,0.,0.,-0.,0.,-0.01,-0.,],
[0.02,0.01,-0.01,0.,-0.01,0.,0.,],
[0.03,-0.,0.,0.01,-0.,0.,-0.01],
[0.02,0.01,0.,-0.,0.,0.,-0.,],
[0.01,0.01,-0.,-0.,-0.,-0.,0.,],
[0.01,0.,0.,-0.,0.,-0.,-0.,]],

[[0.12,0.05,0.01,-0.02,-0.01,-0.,-0.03],
[0.04,0.04,0.,-0.,-0.,-0.,-0.02],
[0.03,-0.,-0.,0.,0.,0.,0.,],
[0.,0.67,0.1,0.01,-0.01,-0.01,-0.08],
[0.01,0.,0.,-0.01,-0.,-0.,0.01],
[0.02,0.01,-0.,-0.,-0.,0.01,-0.01],
[0.05,0.02,-0.,0.,-0.,-0.01,-0.01],
[0.01,0.01,-0.,0.,-0.01,-0.,0.,],
[0.04,0.02,-0.01,-0.,-0.,0.,-0.01],
[-0.,0.,-0.,0.,-0.,-0.,0.01]],

[[0.02,0.01,0.,0.01,0.,0.,0.,],
[0.,0.01,0.,0.,-0.,-0.,0.01],
[0.01,-0.,-0.01,0.,0.,-0.01,-0.01],
[0.01,0.,-0.,-0.,0.,0.,-0.01],
[0.,0.53,0.,0.04,0.02,0.01,0.02],
[0.01,0.01,-0.,0.01,-0.01,0.01,-0.,],
[0.,0.01,-0.,-0.,0.,-0.,-0.,],
[0.01,0.,0.,-0.,-0.,-0.,0.,],
[-0.,0.,0.,-0.,-0.,0.,-0.01],
[-0.,-0.,0.,0.,-0.01,0.,-0.,]],

[[0.02,0.02,0.,0.,0.,-0.,0.01],
[0.01,0.,0.01,0.,-0.,0.,0.01],
[0.02,-0.,0.,-0.,-0.01,-0.,0.,],
[0.02,0.01,-0.,0.,-0.,-0.01,-0.,],
[0.01,0.01,-0.,0.,0.01,-0.,0.01],
[0.,0.42,0.08,0.04,0.03,0.03,0.13],
[0.01,0.,0.,0.01,0.,-0.01,-0.,],
[0.01,-0.,0.01,-0.,0.02,-0.,0.,],
[0.,0.01,0.01,0.,-0.,-0.,0.,],
[-0.,-0.,-0.01,0.,0.,0.,0.,]],

[[0.03,0.01,-0.,-0.,0.,0.,-0.,],
[0.,0.,0.,-0.01,0.,0.01,-0.02],
[0.03,0.,-0.,0.,-0.,-0.,0.01],
[0.05,0.02,-0.,-0.,0.,-0.01,-0.,],
[0.,-0.,0.,-0.01,0.,-0.,-0.,],
[0.01,0.,-0.,0.,0.,-0.,0.,],
[0.,0.76,-0.12,-0.04,-0.03,0.03,0.05],
[0.,0.,0.,-0.,0.,0.,-0.,],
[0.02,0.01,-0.,0.,-0.,0.,-0.,],
[0.01,0.,-0.,0.01,0.,-0.01,0.,]],

[[0.02,0.01,0.,-0.,0.,0.,-0.,],
[0.01,0.02,0.,-0.,0.,0.01,0.,],
[0.02,0.,-0.,-0.,0.,0.,-0.,],
[0.01,0.01,-0.,-0.,-0.01,0.01,-0.,],
[0.01,0.,0.,-0.,0.,-0.01,0.01],
[0.01,-0.,0.,0.,0.01,0.,0.,],
[0.,-0.,-0.,0.,-0.,0.,0.,],
[0.,0.45,0.03,0.04,0.02,0.02,0.12],
[0.,0.,0.,0.,-0.,-0.,-0.,],
[-0.,0.,-0.,-0.01,0.,-0.,-0.,]],

[[0.04,0.01,0.01,0.,-0.01,-0.,-0.01],
[0.01,-0.,0.,0.,-0.,-0.,-0.01],
[0.01,-0.,-0.,-0.,-0.,0.,0.,],
[0.04,0.03,0.01,-0.01,-0.,-0.01,-0.01],
[-0.,0.,-0.,-0.,-0.,-0.,-0.,],
[0.,0.,0.01,0.01,-0.,-0.,0.01],
[0.02,0.01,-0.,-0.,0.,0.,-0.,],
[0.,0.01,0.,-0.01,-0.,0.,0.,],
[0.,0.28,0.38,-0.1,0.18,-0.05,0.11],
[-0.,-0.,0.,0.,-0.,-0.,-0.,]],

[[0.,0.,0.,-0.,-0.,0.,0.,],
[0.01,0.01,0.,-0.,-0.,-0.,0.,],
[0.01,0.,0.,-0.,0.,-0.,0.,],
[-0.,0.01,-0.,-0.,-0.,0.,-0.,],
[-0.,-0.01,-0.01,0.,-0.01,0.01,-0.01],
[-0.,0.,0.,-0.,0.,-0.,-0.,],
[0.01,0.,0.01,-0.,0.,-0.,-0.,],
[-0.,-0.,-0.,-0.,0.,-0.,-0.,],
[-0.,0.,-0.,-0.,-0.,0.,-0.,],
[0.,0.37,0.16,0.07,0.04,0.19,0.03]]]




val_matrix = np.zeros((10,10))
time_matrix = np.zeros((10,10))
for geyser in range(0,len(arr)):
    for geyser2 in range(0, len(arr[geyser])):
        max = 0
        time = 0
        i = 0
        for val in arr[geyser][geyser2]:
            if (val > max):
                max = val
                time = i
            i += 1
        val_matrix[geyser][geyser2] = max
        time_matrix[geyser][geyser2] = time

shrekdf = pd.DataFrame(val_matrix, columns = ["BE", "CA", "DE", "DO", "GR", "LN", "LS", "OF", "PT", "PM"])
shrekdf.insert(loc=0, column='Names', value=["BE", "CA", "DE",	"DO",	"GR",	"LN",	"LS",	"OF",	"PT",	"PM"])
shrekdf.set_index('Names', inplace=True)
shrekdf.to_csv(file1)

shrekdf = pd.DataFrame(time_matrix, columns = ["BE", "CA", "DE", "DO", "GR", "LN", "LS", "OF", "PT", "PM"])
shrekdf.insert(loc=0, column='Names', value=["BE", "CA", "DE",	"DO",	"GR",	"LN",	"LS",	"OF",	"PT",	"PM"])
shrekdf.set_index('Names', inplace=True)
shrekdf.to_csv(file2)

